{"version":3,"sources":["algorithms.js","ThreeApp.js","App.js","index.js"],"names":["random_rotations_avro","nums","tau","tf","Math","PI","x1","x2","x3","R","mul","v","add","identity","v_aux","expandDims","H","sub","AxesFromRotation","props","T","THREE","rot_mat","set","pos","quat","scale","decompose","react_default","a","createElement","args","size","position","x","y","z","quaternion","w","BatchAxesFromRotations","rot_mats","res","i","push","key","slice","Fragment","WireSphere","opacity","window","innerWidth","innerHeight","depthTest","wireframe","transparent","color","MainCanvas","react_three_fiber_esm","attach","OrbitControls","fov","near","far","aspect","lookAt","dataSync","num_rots","AVRO","SPIRAL","defaultMethod","defaultAvro","defaultSpiral","num_sphere_pts","num_xy_rots","AvroSettings","_useState","useState","_useState2","Object","slicedToArray","val","setVal","htmlFor","type","id","value","onChange","e","target","onClick","onSettingChange","parseInt","SpiralSettings","_useState3","_useState4","sphereVal","setSphereVal","_useState5","_useState6","xyVal","setXyVal","DetailedSettings","method","Selections","_useState7","_useState8","setMethod","style","backgroundColor","top","new_method","Reference","bottom","href","App","_React$Component","_getPrototypeOf2","_this","classCallCheck","this","_len","arguments","length","Array","_key","possibleConstructorReturn","getPrototypeOf","call","apply","concat","state","inherits","createClass","settings","setState","normalize","pts","div","cross","b","_tf$split","_tf$split2","a1","a2","a3","_tf$split3","_tf$split4","b1","b2","b3","c1","c2","c3","epsilon","n","theta","phi","z_vecs","y_vecs","x_vecs","Rz","rads","Rxy","tile","reshape","matMul","grid_rotations_spiral","width","height","ThreeApp","bind","React","Component","ReactDOM","createRoot","document","getElementById","render","StrictMode","src_App_0"],"mappings":"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","file":"static/js/main.759f1cd9.chunk.js","sourcesContent":["import * as tf from '@tensorflow/tfjs'\n\n/** Signature of Algorithms\n *Returns: nums of Matrix3\n **/\n\nfunction random_rotations_avro(nums) {\n    let tau = tf.scalar(2 * Math.PI);\n    let x1 = tf.randomUniform([nums], 0, 1);\n    let x2 = tf.randomUniform([nums], 0, 1);\n    let x3 = tf.randomUniform([nums], 0, 1);\n    let R = tf.stack(\n        [\n            tf.stack([tf.cos(tf.mul(tau, x1)), tf.sin(tf.mul(tau, x1)), tf.zeros([nums])], 1),\n            tf.stack([tf.sin(tf.mul(tau, x1).mul(-1)), tf.cos(tf.mul(tau, x1)), tf.zeros([nums])], 1),\n            tf.stack([tf.zeros([nums]), tf.zeros([nums]), tf.ones([nums])], 1),\n        ], 1);\n    let v = tf.stack(\n        [\n            tf.cos(x2.mul(tau)).mul(tf.sqrt(x3)),\n            tf.sin(x2.mul(tau)).mul(tf.sqrt(x3)),\n            tf.sqrt(x3.mul(-1).add(1)),\n        ], 1)\n    let identity = tf.eye(3, 3, [nums]);\n    let v_aux = v.expandDims(2).mul(2).mul(v.expandDims(1));\n    let H = identity.sub(v_aux);\n    let rot_mats = tf.matMul(H, R).mul(-1);\n    return rot_mats;\n}\n\nfunction grid_rotations_spiral(num_sphere_pts, num_xy_rots) {\n    function normalize(pts) {\n        return pts.div(tf.norm(pts, 2, 1, true));\n    }\n    function cross(a, b) {\n        let [a1, a2, a3] = tf.split(a, 3, 1);\n        let [b1, b2, b3] = tf.split(b, 3, 1);\n        let c1 = a2.mul(b3).sub(a3.mul(b2));\n        let c2 = a3.mul(b1).sub(a1.mul(b3));\n        let c3 = a1.mul(b2).sub(a2.mul(b1));\n        return tf.concat([c1, c2, c3], 1);\n    }\n\tlet epsilon;\n    let n = num_sphere_pts;\n    if (n >= 600000) {\n        epsilon = 214;\n    } else if (n>= 400000) {\n        epsilon = 75;\n    } else if (n>= 11000) {\n        epsilon = 27;\n    } else if (n>= 890) {\n        epsilon = 10;\n    } else if (n>= 177) {\n        epsilon = 3.33;\n    } else if (n>= 24) {\n        epsilon = 1.33;\n    } else {\n        epsilon = 0.33;\n    }\n\n    const goldenRatio = 1.618033988749895; // (1 + 5**0.5)/2;\n    const i = tf.range(0, n);\n    const theta = i.mul(2 * Math.PI / goldenRatio);\n    const phi = tf.acos( i.add(epsilon).mul(-2/(n-1+2*epsilon)).add(1) );\n    const x = tf.cos(theta).mul(tf.sin(phi));\n    const y = tf.sin(theta).mul(tf.sin(phi));\n    const z = tf.cos(phi);\n    const z_vecs = tf.stack([x, y, z], 1)\n\n    const up_vecs = tf.stack([tf.zeros([n]), tf.ones([n]), tf.zeros([n])], 1);\n    const y_vecs = normalize( cross(z_vecs, up_vecs) );\n    const x_vecs = normalize( cross(y_vecs, z_vecs) );\n    let Rz = tf.stack([x_vecs, y_vecs, z_vecs], 2)  // (num_sphere_pts, 3, 3)\n\n    const rads = tf.range(0, num_xy_rots).mul(2*Math.PI/num_xy_rots);\n    let Rxy = tf.stack([\n        tf.stack([tf.cos(rads), tf.sin(rads), tf.zeros([num_xy_rots])], 1),\n        tf.stack([tf.sin(rads).mul(-1), tf.cos(rads), tf.zeros([num_xy_rots])], 1),\n        tf.stack([tf.zeros([num_xy_rots]), tf.zeros([num_xy_rots]), tf.ones([num_xy_rots])], 1),\n    ], 1)\n\n    let num_rots = num_sphere_pts * num_xy_rots;\n    Rxy = Rxy.expandDims(1).tile([1, num_sphere_pts, 1, 1]).reshape([num_rots, 3, 3])\n    Rz = Rz.expandDims(0).tile([num_xy_rots, 1, 1, 1]).reshape([num_rots, 3, 3])\n    const rot_mats = Rz.matMul(Rxy);  // First rotate x-y coord (local), then Rz\n    return rot_mats;\n}\n// grid_rotations_spiral(2, 2).print();\n\nexport {grid_rotations_spiral, random_rotations_avro};","import React, { useRef } from 'react';\nimport * as THREE from 'three'\nimport { Canvas, useFrame } from '@react-three/fiber'\nimport { OrbitControls } from '@react-three/drei'\n\n\n// Args: {rot_mat: Array of 9, size: number}\nfunction AxesFromRotation(props) {\n  /* Tranform = [R | -z] */\n  const T = new THREE.Matrix4();\n  const rot_mat = props.rot_mat;\n  T.set(\n    rot_mat[0], rot_mat[1], rot_mat[2], - rot_mat[2],\n    rot_mat[3], rot_mat[4], rot_mat[5], - rot_mat[5],\n    rot_mat[6], rot_mat[7], rot_mat[8], - rot_mat[8],\n    0, 0, 0, 1\n  );\n  /* Has to do decompose() in R3F */\n  let pos = new THREE.Vector3();\n  let quat = new THREE.Quaternion();\n  let scale = new THREE.Vector3();\n  T.decompose(pos, quat, scale);\n  return <axesHelper args={[props.size]}\n    position={[pos.x, pos.y, pos.z]}\n    quaternion={[quat.x, quat.y, quat.z, quat.w]} />\n}\n\n// Args: {rot_mats: Array of Nx9, nums: int, size: number }\n// Output: Array of N AxesHelpers\nfunction BatchAxesFromRotations(props) {\n  const rot_mats = props.rot_mats;\n  const size = props.size;\n  const nums = props.nums;\n  let res = [];\n  for (let i = 0; i < nums; ++i) {\n    res.push(\n      <AxesFromRotation key={i} rot_mat={rot_mats.slice(9*i, 9*i+9)} size={size}/>\n      );\n  }\n  return <>{res}</>;\n}\n\nfunction WireSphere() {\n  function detectMobile() {\n    return ((window.innerWidth <= 800) && (window.innerHeight <= 600));\n  }\n  const opacity = detectMobile() ? 0.2 : 0.02;\n  return <mesh position={[0, 0, 0]}>\n    <sphereGeometry args={[1, 32, 16]} />\n    <meshStandardMaterial depthTest={false} wireframe={true} transparent={true}\n      color={0xffffff} opacity={opacity}/>\n  </mesh>\n}\n\nfunction MainCanvas(props) {\n  return (\n    <Canvas>\n      <color args={[0x000000]} attach=\"background\" />\n      <ambientLight />\n\n      <OrbitControls />\n      <perspectiveCamera\n        fov={75} near={0.1} far={1000} aspect={window.innerWidth / window.innerHeight}\n        position={[5, 0, 0]} lookAt={[0, 0, 0]}/>\n\n      <WireSphere />\n      <BatchAxesFromRotations rot_mats={props.rot_mats.dataSync()} nums={props.num_rots} size={0.05}/>\n    </Canvas>\n  );\n}\n\nexport default MainCanvas;\n\n// import { OrbitControls } from 'three/examples/jsm/controls/OrbitControls'\n\n// extend({ OrbitControls })\n\n// const extent = 10\n\n// // generate nice figure with lots of points\n// const y_period = 17\n// const x_period = 13\n// const res = 0.001\n\n// const CameraControls = () => {\n//   const {\n//     camera,\n//     gl: { domElement }\n//   } = useThree()\n//   // Ref to the controls, so that we can update them on every frame using useFrame\n//   const controls = useRef(null)\n//   // useFrame((state) => controls.current.update())\n//   // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n//   // @ts-ignore\n//   return <orbitControls ref={controls} args={[camera, domElement]} />\n// }","import './App.css';\nimport React from 'react';\nimport { useState } from 'react';\nimport {random_rotations_avro, grid_rotations_spiral} from './algorithms'\nimport MainCanvas from './ThreeApp'\n\nconst AVRO = 'avro', SPIRAL = 'spiral';\nconst defaultMethod = AVRO;\nconst defaultAvro = { num_rots: 100 };\nconst defaultSpiral = { num_sphere_pts: 100, num_xy_rots: 3 }\n\nfunction AvroSettings(props) {\n  const [val, setVal] = useState(defaultAvro.num_rots);\n  const onClick = () => {\n    props.onSettingChange(AVRO, { num_rots: parseInt(val) });\n  }\n  return <>\n    <label htmlFor='num_rots'>Number of Rotations:</label>\n    <input type='text' id='num_rots' value={val}\n      onChange={(e) => setVal(e.target.value)}></input>\n    <button onClick={onClick}>Refresh</button>\n  </>\n}\n\nfunction SpiralSettings(props) {\n  const [sphereVal, setSphereVal] = useState(defaultSpiral.num_sphere_pts);\n  const [xyVal, setXyVal] = useState(defaultSpiral.num_xy_rots);\n  const onClick = () => {\n    props.onSettingChange(SPIRAL,\n      { num_sphere_pts: parseInt(sphereVal), num_xy_rots: parseInt(xyVal) });\n  }\n  return <>\n    <div>\n      <label htmlFor='num_sphere_pts'>Number of Sphere Points:</label>\n      <input type='text' id='num_sphere_pts' value={sphereVal}\n        onChange={(e) => setSphereVal(e.target.value)}></input>\n    </div>\n    <div>\n      <label htmlFor='num_xy_pts'>Number of XY Rotations:</label>\n      <input type='text' id='num_xy_rots' value={xyVal}\n        onChange={(e) => setXyVal(e.target.value)}></input>\n      <button onClick={onClick}>Refresh</button>\n    </div>\n  </>\n}\n\nfunction DetailedSettings(props) {\n  if (props.method === AVRO) {\n    return <AvroSettings onSettingChange={props.onSettingChange} />\n  } else if (props.method === SPIRAL) {\n    return <SpiralSettings onSettingChange={props.onSettingChange} />\n  }\n}\n\nfunction Selections(props) {\n  const [method, setMethod] = useState(defaultMethod);\n  const onChange = (e) => {\n    const new_method = e.target.value;\n    setMethod(new_method)\n    if (new_method === AVRO) { props.onSettingChange(new_method, defaultAvro); }\n    else if (new_method === SPIRAL) { props.onSettingChange(new_method, defaultSpiral); }\n  };\n  return <div style={{ color: 'white', backgroundColor: 'transparent', position: 'absolute', top: '0px' }}>\n    <div>\n      <label htmlFor=\"method-select\">Generation Method:</label>\n      <select id=\"method-select\" onChange={onChange}>\n        <option value={AVRO}>Random-Avro</option>\n        <option value={SPIRAL}>Spiral</option>\n      </select>\n    </div>\n    <DetailedSettings method={method} onSettingChange={props.onSettingChange}/>\n  </div>\n}\n\nfunction Reference() {\n  return <div style={{ color: 'white', backgroundColor: 'transparent', position: 'absolute', bottom: '0px' }}>\n    <p>Reference:</p>\n    <ol>\n      <li>J Avro. \"Fast Random Rotation Matrices.\" (1992)</li>\n      <li><a href=\"https://gist.github.com/zhifanzhu/a1d2a108ad6ea81b853a67d2420b01be\">Spiral method.</a></li>\n    </ol>\n  </div>\n}\n\nclass App extends React.Component {\n  state = {\n    rot_mats: random_rotations_avro(defaultAvro.num_rots),\n    num_rots: defaultAvro.num_rots,\n  }\n  onSettingChange(method, settings) {\n    if (method === AVRO) {\n      const rot_mats = random_rotations_avro(settings.num_rots);\n      this.setState({num_rots: settings.num_rots});\n      this.setState({rot_mats: rot_mats});\n    } else if (method === SPIRAL) {\n      const rot_mats = grid_rotations_spiral(\n        settings.num_sphere_pts, settings.num_xy_rots);\n      this.setState({num_rots: settings.num_sphere_pts * settings.num_xy_rots});\n      this.setState({rot_mats: rot_mats});\n    }\n  }\n  render() {\n    return <div style={{ width: window.innerWidth, height: window.innerHeight }}>\n      <MainCanvas rot_mats={this.state.rot_mats} num_rots={this.state.num_rots} />\n      <Selections onSettingChange={this.onSettingChange.bind(this)}/>\n      <Reference />\n    </div>\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport './index.css';\nimport App from './App';\n\nconst root = ReactDOM.createRoot(document.getElementById('root'));\nroot.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>\n);"],"sourceRoot":""}